import{_ as s,o as n,c as a,V as e}from"./chunks/framework.2ee15143.js";const _=JSON.parse('{"title":"常见问题","description":"","frontmatter":{},"headers":[],"relativePath":"frame/issues.md","lastUpdated":1690962726000}'),l={name:"frame/issues.md"},o=e(`<h1 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to &quot;常见问题&quot;">​</a></h1><h3 id="为什么修改了数据库数据-查询时数据并未更改" tabindex="-1">为什么修改了数据库数据，查询时数据并未更改? <a class="header-anchor" href="#为什么修改了数据库数据-查询时数据并未更改" aria-label="Permalink to &quot;为什么修改了数据库数据，查询时数据并未更改?&quot;">​</a></h3><div class="tip custom-block"><p class="custom-block-title">回答</p><p>部分数据采用热缓存，如果直接更新数据库，缓存并未更新。</p><p>可以尝试清空redis缓存试试</p></div><h3 id="如果使用linux-提示表不存在" tabindex="-1">如果使用Linux 提示表不存在? <a class="header-anchor" href="#如果使用linux-提示表不存在" aria-label="Permalink to &quot;如果使用Linux 提示表不存在?&quot;">​</a></h3><div class="tip custom-block"><p class="custom-block-title">回答</p><p>设置大小写敏感配置在/etc/my.cnf添加lower_case_table_names=1，重启MYSQL服务</p></div><h3 id="项目启动后登录异常" tabindex="-1">项目启动后登录异常？ <a class="header-anchor" href="#项目启动后登录异常" aria-label="Permalink to &quot;项目启动后登录异常？&quot;">​</a></h3><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">[http-nio-9218-exec-8] INFO c.c.m.o.s.i.LoginServiceImpl - [login,151]</span></span>
<span class="line"><span style="color:#babed8;"> - 用户:admin登录客户端:失败Authentication failed for token submission</span></span>
<span class="line"><span style="color:#babed8;">[cn.com.mfish.oauth.common.MyUsernamePasswordToken - admin, rememberMe=false].</span></span>
<span class="line"><span style="color:#babed8;">Possible unexpected error?(Typical or expected login exceptions should extend from AuthenticationException).</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">回答</p><p>可以通过清空redis缓存再试。如果还是无法登录需要排查其他问题。下面也是登录失败案例。</p></div><div class="language-text line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#babed8;">[http-nio-9218-exec-8] INFO c.c.m.o.s.i.LoginServiceImpl - [login,151] - 用户:admin登录客户端:失败Authentication failed for token submission [cn.com.mfish.oauth.common.MyUsernamePasswordToken - admin, rememberMe=false]. Possible unexpected error? (Typical or expected login exceptions should extend from AuthenticationException).</span></span>
<span class="line"><span style="color:#babed8;">[http-nio-9218-exec-6] INFO c.c.m.o.c.AuthorizeController - [authorize,101] - 用户:null登录状态:false</span></span>
<span class="line"><span style="color:#babed8;">[http-nio-9218-exec-6] DEBUG c.c.m.o.m.S.getUserById - [debug,137] - ==&gt; Preparing: select u., GROUP_CONCAT(DISTINCT role_id) roleIds, GROUP_CONCAT(DISTINCT org_id) orgIds from (select u., ou.org_id, ur.role_id from sso_user u left join sso_org_user ou on ou.user_id = u.id left join sso_org o on o.id = ou.org_id AND o.status = 0 and o.del_flag = 0 left join sso_user_role ur on u.id = ur.user_id left join sso_role r on r.id = ur.role_id and r.del_flag = 0 and r.status = 0 union select u., ou.org_id, sor.role_id from sso_user u join sso_org_user ou on ou.user_id = u.id join sso_org o on o.id = ou.org_id AND o.status = 0 and o.del_flag = 0 join sso_org_role sor on sor.org_id = o.id join sso_role r on r.id = sor.role_id and r.del_flag = 0 and r.status = 0) u WHERE u.id = ? group by u.id</span></span>
<span class="line"><span style="color:#babed8;">[http-nio-9218-exec-6] DEBUG c.c.m.o.m.S.getUserById - [debug,137] - ==&gt; Parameters: 1(String)</span></span>
<span class="line"><span style="color:#babed8;">[http-nio-9218-exec-6] ERROR druid.sql.Statement - [statementLogError,148] - {conn-10005, pstmt-20010} execute error. select u., GROUP_CONCAT(DISTINCT role_id) roleIds, GROUP_CONCAT(DISTINCT org_id) orgIds</span></span>
<span class="line"><span style="color:#babed8;">from (select u.*, ou.org_id, ur.role_id</span></span>
<span class="line"><span style="color:#babed8;">from sso_user u</span></span>
<span class="line"><span style="color:#babed8;">left join sso_org_user ou on ou.user_id = u.id</span></span>
<span class="line"><span style="color:#babed8;"></span></span>
<span class="line"><span style="color:#babed8;">            left join</span></span>
<span class="line"><span style="color:#babed8;">         </span></span>
<span class="line"><span style="color:#babed8;">    sso_org o on o.id = ou.org_id</span></span>
<span class="line"><span style="color:#babed8;">     </span></span>
<span class="line"><span style="color:#babed8;">    AND o.status = 0 and o.del_flag = 0</span></span>
<span class="line"><span style="color:#babed8;">     </span></span>
<span class="line"><span style="color:#babed8;"> </span></span>
<span class="line"><span style="color:#babed8;">    left join sso_user_role ur on u.id = ur.user_id</span></span>
<span class="line"><span style="color:#babed8;">    left join sso_role r on r.id = ur.role_id and r.del_flag = 0 and r.status = 0</span></span>
<span class="line"><span style="color:#babed8;">    union</span></span>
<span class="line"><span style="color:#babed8;">    select u.*, ou.org_id, sor.role_id</span></span>
<span class="line"><span style="color:#babed8;">    from sso_user u</span></span>
<span class="line"><span style="color:#babed8;">    join sso_org_user ou on ou.user_id = u.id</span></span>
<span class="line"><span style="color:#babed8;">    join sso_org o on o.id = ou.org_id</span></span>
<span class="line"><span style="color:#babed8;">     </span></span>
<span class="line"><span style="color:#babed8;">    AND o.status = 0 and o.del_flag = 0</span></span>
<span class="line"><span style="color:#babed8;">     </span></span>
<span class="line"><span style="color:#babed8;"> </span></span>
<span class="line"><span style="color:#babed8;">    join sso_org_role sor on sor.org_id = o.id</span></span>
<span class="line"><span style="color:#babed8;">    join sso_role r on r.id = sor.role_id and r.del_flag = 0 and r.status = 0) u</span></span>
<span class="line"><span style="color:#babed8;"> </span></span>
<span class="line"><span style="color:#babed8;">     WHERE u.id = ? </span></span>
<span class="line"><span style="color:#babed8;">    group by u.id</span></span>
<span class="line"><span style="color:#babed8;">java.sql.SQLSyntaxErrorException: Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column &#39;u.account&#39; which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">回答</p><p>由于mysql5.7以上版本默认不支持group by以后查询非group by字段，系统中使用了类似SQL可以通过</p><p>修改mysql配置my.ini或者my.conf中的sql_mode配置，去除only_full_group_by选项</p><p>如下:</p><p>sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES</p></div><p>如遇到无法解决的问题请到<a href="https://github.com/mfish-qf/mfish-nocode/issues" target="_blank" rel="noreferrer">Issues</a>反馈，会不定时进行解答。</p>`,11),r=[o];function p(i,c,t,d,b,u){return n(),a("div",null,r)}const g=s(l,[["render",p]]);export{_ as __pageData,g as default};
